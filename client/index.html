<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!--<link rel="manifest" href="site.webmanifest">-->
        <!--<link rel="apple-touch-icon" href="icon.png">-->
        <!-- Place favicon.ico in the root directory -->

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css">
        <style>
          html, body { font-family: sans-serif; }
          label, input { display: block; }
          input { width: 100%; }
          .restaurantForm {
            max-width: 600px;
            padding: 8px;
          }
        </style>
    </head>

    <body>
        <!--[if lte IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
        <script src="https://unpkg.com/vue@2.5.2/dist/vue.js"></script>

        <div id="app"></div>

        <script id="template-app-root" type="text/x-template">
          <div class="restaurants-app">
            <h1> Hello </h1>
            <restaurant-form></restaurant-form>
          </div>
        </script>

        <script id="template-post-restaurant" type="text/x-template">
          <div class="restaurantForm">
            <div class="controlGroup">
              <label> Name </label>
              <input type="text" v-model="name" />
            </div>

            <div class="controlGroup">
              <label> Address </label>
              <input type="text" v-model="address" />
            </div>

            <div class="controlGroup">
              <label> Tags </label>
              <input type="text" v-model="tags" />
            </div>

            <div class="controlGroup">
              <button type="button" @click="submitRestaurant"> Submit </button>
            </div>
          </div>
        </script>

        <script>
          new Vue({
            el: '#app',
            name: 'RestaurantsApp',
            template: '#template-app-root',

            data: {
              restaurants: null
            },

            created: function created () {
              fetch('/api/restaurants')
                .then(resp => resp.json())
                .then(data => {
                  console.info(data)
                  this.restaurants = data.restaurants
                })
            },

            components: {
              RestaurantForm: {
                template: '#template-post-restaurant',
                data: function () {
                  return {
                    name: '',
                    address: '',
                    tags: []
                  }
                },

                methods: {
                  submitRestaurant: function submitRestaurant () {
                    const body = JSON.stringify({
                      name: this.name,
                      address: this.address,
                      tags: this.tags
                    })

                    fetch('/api/restaurants', {
                      method: 'POST',
                      headers: { 'Content-Type': 'application/json' },
                      body
                    })
                      .then(resp => resp.json())
                      .then(data => {
                        console.info(data)
                        this.name = ''
                        this.address = ''
                        this.tags = []
                      })
                      .catch(err => {
                        console.error('err')
                      })
                  }
                }
              }
            }
          })
        </script>

        <!--[><script src="js/vendor/modernizr-3.5.0.min.js"></script><]-->
        <!--[><script src="js/main.js"></script><]-->

        <!--[> Google Analytics: change UA-XXXXX-Y to be your site's ID. <]-->
        <!--<script>-->
            <!--window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;-->
            <!--ga('create','UA-XXXXX-Y','auto');ga('send','pageview')-->
        <!--</script>-->
        <!--<script src="https://www.google-analytics.com/analytics.js" async defer></script>-->
    </body>
</html>
